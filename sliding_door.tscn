[gd_scene load_steps=9 format=3 uid="uid://bbfksrj17d8sy"]

[ext_resource type="PackedScene" uid="uid://bm2num3cbkjcf" path="res://cable_socket.tscn" id="1_ee71f"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_xrdls"]

[sub_resource type="BoxShape3D" id="BoxShape3D_txn40"]
size = Vector3(1, 0.1, 3)

[sub_resource type="BoxMesh" id="BoxMesh_o8wkh"]
size = Vector3(1, 0.1, 3)

[sub_resource type="GDScript" id="GDScript_82x0y"]
script/source = "extends SliderJoint3D

@export var plug: CableSocket
@export_range(0, 1, 0.001, \"or_less\", \"or_greater\", \"suffix:m\") var slide: float = 0.5
@export_range(0, 5, 0.5, \"or_greater\") var max_power := 1.0

func _physics_process(delta: float) -> void:
	var v: float = plug.power if plug else 0.0
	var target := clampf(v / max_power, 0, 1) * slide
	set(\"linear_limit/lower_distance\", move_toward(get(\"linear_limit/lower_distance\"), target, 10 * delta))
	set(\"linear_limit/upper_distance\", move_toward(get(\"linear_limit/upper_distance\"), target, 10 * delta))
"

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_ojnaf"]

[sub_resource type="BoxShape3D" id="BoxShape3D_qivab"]
size = Vector3(1, 1, 0.1)

[sub_resource type="BoxMesh" id="BoxMesh_m2wj8"]
size = Vector3(1, 1, 0.1)

[node name="sliding_door" type="Node3D"]
transform = Transform3D(-4.37114e-08, 4.04332e-11, 1, 0.000925004, 1, 0, -1, 0.000925004, -4.37114e-08, 0, 0, 0)

[node name="StaticBody3D4" type="StaticBody3D" parent="."]
transform = Transform3D(-4.37114e-08, 0.000925004, -1, 4.04332e-11, 1, 0.000925004, 1, 0, -4.37114e-08, -1.05749, -0.262098, -1.19209e-07)
physics_material_override = SubResource("PhysicsMaterial_xrdls")

[node name="plug4" parent="StaticBody3D4" instance=ExtResource("1_ee71f")]
transform = Transform3D(1, -1.65436e-24, -3.38813e-21, -1.65436e-24, 1, -9.40395e-38, -3.38813e-21, 0, 1, -0.27053, 0, 0)
idle_drain = 0.75

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D4"]
transform = Transform3D(1, -8.27181e-24, -1.69407e-20, -1.65436e-24, 1, -3.76158e-37, -1.69407e-20, 1.05795e-37, 1, 6.39488e-14, -0.302074, -0.98171)
shape = SubResource("BoxShape3D_txn40")

[node name="MeshInstance3D" type="MeshInstance3D" parent="StaticBody3D4/CollisionShape3D"]
transform = Transform3D(1, -1.65436e-24, -3.38813e-21, -1.65436e-24, 1, -9.40395e-38, -3.38813e-21, 0, 1, 0, 0, 0)
mesh = SubResource("BoxMesh_o8wkh")

[node name="SliderJoint3D" type="SliderJoint3D" parent="StaticBody3D4" node_paths=PackedStringArray("plug")]
transform = Transform3D(-4.37114e-08, 4.04332e-11, 1, 0.000925004, 1, 0, -1, 0.000925004, -4.37114e-08, -3.80066e-08, -0.0341419, -2.02269)
node_a = NodePath("..")
node_b = NodePath("RigidBody3D")
script = SubResource("GDScript_82x0y")
plug = NodePath("../plug4")
slide = 0.75

[node name="RigidBody3D" type="RigidBody3D" parent="StaticBody3D4/SliderJoint3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.96516, 0.298111, 2.18575e-16)
physics_material_override = SubResource("PhysicsMaterial_ojnaf")
can_sleep = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D4/SliderJoint3D/RigidBody3D"]
shape = SubResource("BoxShape3D_qivab")

[node name="MeshInstance3D" type="MeshInstance3D" parent="StaticBody3D4/SliderJoint3D/RigidBody3D"]
mesh = SubResource("BoxMesh_m2wj8")

[node name="CSGBox3D" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, -1.02349e-15, 1.04805e-12, -1.02349e-15, 1, -0.0850525, 1.45519e-11, -1.95399e-13)
use_collision = true
size = Vector3(2.95697, 1, 0.456055)

[node name="CSGBox3D" type="CSGBox3D" parent="CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, -2.57086e-15, 2.63256e-12, -2.57086e-15, 1, 0.0401716, 3.63798e-12, 4.9738e-14)
operation = 2
size = Vector3(0.77706, 1, 1.308)

[node name="CSGBox3D2" type="CSGBox3D" parent="CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, -2.58474e-15, 2.64677e-12, -2.58474e-15, 1, 0.477425, -0.0825806, 7.79599e-13)
operation = 2
size = Vector3(1.83202, 1.3407, 0.236328)
